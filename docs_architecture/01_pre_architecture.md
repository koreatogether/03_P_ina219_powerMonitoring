# INA219 Power Monitoring System 1차 아키텍처 설계

## 1. 전체 시스템 개요
- **목표**: INA219 센서를 활용한 실시간 전력/전압/전류 모니터링 및 데이터 시각화, 분석 대시보드 구축
- **구성**:
    - 아두이노 기반 센서 측정 및 OLED UI
    - PC/서버와의 시리얼 통신(정방향: 데이터 송신, 역방향: 설정/제어 명령)
    - Python 기반 대시보드(데이터 수신, 시각화, 분석)

## 2. 주요 모듈 및 역할
### 2.1 아두이노(uno_r4_wifi)
- INA219 센서로 W/V/A 실시간 측정
- OLED(SSD1306)로 그래프 및 정보 패널 표시
- 로터리 엔코더, 부저 등 UI/UX 기능
- 시리얼 통신으로 데이터 전송(JSON 형식 추천)
- (옵션) PC/서버로부터 설정/제어 명령 수신

### 2.2 통신 설계
- **정방향(아두이노 → PC/서버)**
    - 데이터 포맷: JSON (예: `{ "timestamp": ..., "voltage": ..., "current": ..., "power": ... }`)
    - 주기적/이벤트 기반 데이터 송신
- **역방향(PC/서버 → 아두이노)**
    - 설정값 변경, 측정 모드 변경 등 제어 명령
    - 명령 포맷: JSON 또는 간단 텍스트 명령
- **통신 방식**: 시리얼(UART/USB)
- **에러 처리**: 데이터 무결성 체크, 재전송, ACK/NACK

### 2.3 Python 대시보드
- 시리얼 포트로 데이터 수신
- 실시간 그래프(Plotly, Matplotlib 등)
- 데이터 저장 및 분석(이동평균, min/max, 통계)
- UI: 데이터 표시, 분석 결과, 설정값 변경 등
- (옵션) 웹 기반 대시보드 확장 가능

## 3. 데이터 흐름
1. 아두이노에서 센서값 측정 → OLED 표시
2. 측정값을 JSON으로 시리얼 송신
3. PC/서버(Python)에서 데이터 수신 → 실시간 시각화/저장/분석
4. 필요시 PC/서버에서 아두이노로 설정/제어 명령 송신

## 4. 설계 추천 및 확장 방향
- **통신 포맷**: JSON 사용(확장성, 가독성, 타 시스템 연동 용이)
- **분석 기능**: 이동평균, min/max, 이상치 탐지, 장기 데이터 저장
- **대시보드**: 실시간/과거 데이터 조회, 그래프, 통계, 설정 UI
- **확장성**: 웹 대시보드, 클라우드 연동, 다중 센서 지원

## 5. 폴더 구조 제안
- `src/arduino/` : 아두이노 펌웨어
- `src/python/data_processing/` : 데이터 수집/분석
- `src/python/dashboard/` : 대시보드 앱
- `docs_architecture/` : 설계 문서

---

본 설계는 아두이노 기반 실시간 전력 모니터링 시스템의 1차 구조로, 시리얼+JSON 통신을 중심으로 데이터 흐름과 각 모듈의 역할을 정의함. 이후 실제 구현 및 테스트를 통해 상세 설계와 최적화가 진행될 예정.
